<div class="services-container">
  <div class="services-header">
    <h1>Professional Home Services</h1>
    <p>Expert assemblers and contractors for all your home improvement needs</p>
  </div>

  <!-- Search and Filter Section -->
  <div class="search-filter-section">
    <div class="search-bar">
      <div class="search-input-container">
        <i class="icon-search"></i>
        <input 
          type="text" 
          placeholder="Search services..." 
          [(ngModel)]="searchTerm"
          (input)="onSearch()"
          class="search-input">
      </div>
    </div>

    <div class="filters">
      <div class="category-filters">
        <h3>Categories</h3>
        <div class="category-buttons">
          <button 
            class="category-btn" 
            [class.active]="selectedCategory === 'all'"
            (click)="onCategorySelect('all')">
            All Services
          </button>
          <button 
            *ngFor="let category of categories" 
            class="category-btn"
            [class.active]="selectedCategory === category.Id"
            (click)="onCategorySelect(category.Id)">
            {{ category.Name }}
          </button>
        </div>
      </div>

      <div class="sort-filters">
        <h3>Sort By</h3>
        <select [(ngModel)]="sortBy" (change)="onSortChange()" class="sort-select">
          <option value="name">Name (A-Z)</option>
          <option value="price-low">Price (Low to High)</option>
          <option value="price-high">Price (High to Low)</option>
          <option value="rating">Rating (High to Low)</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message" style="background: #ffebee; color: #c62828; padding: 15px; margin: 20px 0; border-radius: 5px; border-left: 4px solid #c62828;">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <div>
        <strong>Error:</strong> {{ errorMessage }}
      </div>
      <button class="btn-secondary" (click)="retryLoading()" style="margin-left: 15px;">
        <i class="fas fa-redo"></i> Retry
      </button>
    </div>
  </div>

  <!-- Loading Message -->
  <div *ngIf="isLoading" class="loading-message" style="text-align: center; padding: 40px; color: #666;">
    <div style="display: inline-block; margin-bottom: 15px;">
      <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #007bff;"></i>
    </div>
    <p>Loading services...</p>
  </div>

  <!-- Results Count -->
  <div class="results-info" *ngIf="!isLoading">
    <p>{{ filteredServices.length }} service{{ filteredServices.length !== 1 ? 's' : '' }} found</p>
  </div>

  <!-- Services Grid -->
  <div class="services-grid" *ngIf="!isLoading">
    <div 
      *ngFor="let service of filteredServices" 
      class="service-card"
      (click)="onServiceClick(service.Id)">
      <div class="service-image">
        <img [src]="service.ImageUrl || '/assets/services/placeholder.jpg'" [alt]="service.Name || 'Service'" onerror="this.src='/assets/services/placeholder.jpg'">
        <div class="service-category-badge">{{ service.Category?.Name || 'General' }}</div>
      </div>
      <div class="service-content">
        <h3>{{ service.Name || 'Service' }}</h3>
        <p class="service-description">{{ service.Description || 'No description available' }}</p>
        <div class="service-meta">
          <div class="service-rating">
            <span class="stars" [innerHTML]="getStarRating(service.AverageRating || 0)"></span>
            <span class="rating-text">{{ service.AverageRating || 0 }} ({{ service.ReviewCount || 0 }} reviews)</span>
          </div>
          <div class="service-price">{{ service.Price || 0 }} JD/hour</div>
        </div>
        <div class="service-actions">
          <button class="btn-primary" (click)="onServiceClick(service.Id); $event.stopPropagation()">
            <i class="fas fa-users"></i>
            View Assemblers
          </button>
          <button class="btn-secondary" (click)="onBookService(service.Id); $event.stopPropagation()">
            <i class="fas fa-calendar-plus"></i>
            Book Service
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && filteredServices.length === 0" class="no-services">
    <div class="no-services-content">
      <i class="icon-search-large"></i>
      <h3>No services found</h3>
      <p>Try adjusting your search or filter criteria</p>
      <button class="btn-secondary" (click)="clearFilters()">Clear Filters</button>
    </div>
  </div>
</div>